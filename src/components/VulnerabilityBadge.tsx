import { cn } from '@/lib/utils'
import { Shield, ShieldCheck, ShieldAlert, AlertTriangle } from 'lucide-react'

interface VulnerabilityBadgeProps {
  vulnerable: boolean
  confidence: 'high' | 'medium' | 'low' | null
  size?: 'sm' | 'md' | 'lg'
  className?: string
}

export function VulnerabilityBadge({ vulnerable, confidence, size = 'md', className }: VulnerabilityBadgeProps) {
  const sizeClasses = {
    sm: 'px-3 py-1 text-xs gap-1.5',
    md: 'px-4 py-2 text-sm gap-2',
    lg: 'px-6 py-3 text-base gap-2',
  }

  const iconSizes = {
    sm: 'h-3.5 w-3.5',
    md: 'h-4 w-4',
    lg: 'h-5 w-5',
  }

  let label: string
  let statusClassName: string
  let Icon: any

  if (vulnerable) {
    if (confidence === 'high') {
      label = 'VULNERABLE'
      statusClassName = 'bg-destructive text-destructive-foreground animate-pulse-glow glow-red'
      Icon = ShieldAlert
    } else if (confidence === 'medium') {
      label = 'LIKELY VULNERABLE'
      statusClassName = 'bg-orange-500 text-white glow-orange'
      Icon = AlertTriangle
    } else {
      label = 'POSSIBLY VULNERABLE'
      statusClassName = 'bg-yellow-500 text-white glow-yellow'
      Icon = AlertTriangle
    }
  } else {
    label = 'NOT VULNERABLE'
    statusClassName = 'bg-green-500 text-white glow-green'
    Icon = ShieldCheck
  }

  return (
    <div
      className={cn(
        'inline-flex items-center font-semibold rounded-full uppercase tracking-wide',
        sizeClasses[size],
        statusClassName,
        className
      )}
    >
      <Icon className={iconSizes[size]} />
      {label}
    </div>
  )
}
